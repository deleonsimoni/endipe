<!--==========================
    Submission
  ============================-->
<main id="submission">
    <div class="container submission-content">
        <div class="row">
            <div class="offset-md-1 col-md-10">
                <div class="box">
                    <div class="section-header">
                        <h2>Painel Gerencial</h2>
                    </div>

                    <input type="text" class="form-control mb-4" [(ngModel)]="search" placeholder="Filtrar participante"
                        (keyup)="searchUser()">

                    <div *ngFor="let user of users; let i = index" [ngClass]="{'mb-3': users.length > 1}">
                        <div class="card-works" [ngClass]="{'no-radius-bottom': infos == true}">
                            <div class="row">
                                <div class="col-sm-1 border-right">
                                    <small>ID</small>
                                    <h4>{{ i + 1 }}</h4>
                                </div>
                                <div class="col-sm-3 border-right">
                                    <small>NOME</small>
                                    <h4>{{ user.fullname }}</h4>
                                </div>
                                <div class="col-sm-3 border-right">
                                    <small>EMAIL</small>
                                    <h4>{{ user.email }}</h4>
                                </div>
                                <div class="col-sm-2 border-right">
                                    <small>CPF</small>
                                    <h4>{{ user.document }}</h4>
                                </div>
                                <div class="col-sm-2 border-right">
                                    <small>STATUS</small>
                                    <h4>{{ user.payment && user.payment.icPaid == true ? 'Pagamento efetuado' : 'Aguardando liberação' }}
                                    </h4>
                                </div>
                                <div class="col-sm-1 text-center align-self-center pointer"
                                    (click)="(infos ? infos = false : infos = true);selectUser(user._id)">
                                    <i class="fa fa-chevron-down"></i>
                                </div>
                            </div>
                        </div>
                        <div class="work-content" *ngIf="user._id == userSelect" @showInfos>
                            <div class="section first">
                                <h6>Dados pessoais</h6>
                            </div>
                            <div class="row align-items-center">
                                <div class="col-sm-4 mb-2">
                                    <strong>Telefone</strong>
                                    <p>{{ user.phones.telephone ? user.phones.telephone : '-----' }}</p>
                                </div>
                                <div class="col-sm-4 mb-2">
                                    <strong>Celular</strong>
                                    <p>{{ user.phones.cellphone ? user.phones.cellphone : '-----' }}</p>
                                </div>
                                <div class="col-sm-4 mb-2">
                                    <strong>Data de inscrição</strong>
                                    <p>{{ user.createdAt | date: 'dd/MM/yyyy' }}</p>
                                </div>
                            </div>
                            <div class="section">
                                <h6>Pagamento</h6>
                            </div>
                            <div class="row align-items-center">
                                <div class="col-sm-4">
                                    <strong>Categoria</strong>
                                    <p>{{ user.payment && user.payment.categoryId ? retrieveCategories(user.payment.categoryId).name : '----' }}
                                    </p>
                                </div>
                                <div class="col-sm-4">
                                    <strong>Valor total</strong>
                                    <p>{{ user.payment && user.payment.amount ? 'R$ ' + user.payment.amount : '----' }}
                                    </p>
                                </div>
                                <div class="col-sm-4">
                                    <strong>Confirmar pagamento</strong>
                                    <div *ngIf="user.payment" class="form-group">
                                        <div class="btn-group" role="group" aria-label="Basic example">
                                            <button (click)="validarPagamento(user)"
                                                [ngStyle]="{'background-color: green;color:white':  user.payment.icPaid, 'background-color: white;color: black': user.payment.icPaid}"
                                                type="button" [ngClass]="{'btn btn-success': user.payment.icPaid}"
                                                class="btn">Sim</button>
                                            <button (click)="invalidarPagamento(user)"
                                                [ngStyle]="{'background-color: red;color:white':  !user.payment.icPaid, 'background-color: white;color: black': user.payment.icPaid}"
                                                type="button" [ngClass]="{'btn btn-danger': !user.payment.icPaid}"
                                                class="btn">Não</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <p><a [routerLink]="" (click)="download(user.payment.pathS3)">Download
                                            comprovante</a>
                                    </p>
                                </div>
                            </div>
                            <div class="section">
                                <h6>Trabalhos</h6>
                            </div>
                            <div class="row" *ngFor="let work of user.works">
                                <div class="col-sm-4 align-self-center">
                                    <strong>Título</strong>
                                    <p>{{ work.title }}</p>
                                </div>
                                <div class="col-sm-4 align-self-center">
                                    <strong>Eixo</strong>
                                    <p>{{ work.axisId }}</p>
                                </div>
                                <div class="col-sm-4 align-self-center">
                                    <strong>Modalidade</strong>
                                    <p>{{ retrieveModality(user.modalityId[0]).name }}</p>
                                </div>
                                <div class="col-sm-4 mt-2">
                                    <strong>Autores</strong>
                                    <span *ngFor="let author of work.authors">
                                        <p>{{ author.email }}</p>
                                    </span>
                                </div>
                                <div class="col-sm-4 mt-2">
                                    <strong>Arquivos</strong>
                                    <p><a [routerLink]="" (click)="download(work.pathS3DOC)">Download doc</a>
                                    </p>
                                    <p><a [routerLink]="" (click)="download(work.pathS3PDF)">Download pdf</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>